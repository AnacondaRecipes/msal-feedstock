{% set name = "msal" %}
{% set version = "1.33.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 836ad80faa3e25a7d71015c990ce61f704a87328b1e73bcbb0623a18cbf17510

build:
  number: 0
  skip: true  # [py<37]
  script: {{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation

requirements:
  host:
    - setuptools
    - python
    - wheel
    - pip
  run:
    - python
    - requests >=2.0.0,<3
    - pyjwt >=1.0.0,<3
    - cryptography >=2.5,<48
  run_constrained:
    - pymsalruntime >=0.14,<0.19  # [py>36 and win]
    - pymsalruntime >=0.17,<0.19  # [py>38 and osx]
    - pymsalruntime >=0.18,<0.19  # [py>38 and linux]
test:
  requires:
    - pip
  imports:
    - msal
    - msal.application
    - msal.authority
    - msal.cloudshell
    - msal.exceptions
    - msal.individual_cache
    - msal.managed_identity
    - msal.mex
    - msal.oauth2cli
    - msal.oauth2cli.authcode
    - msal.oauth2cli.oidc
    - msal.telemetry
    - msal.throttled_http_client
    - msal.token_cache
    - msal.wstrust_response
  commands:
    - pip check
    - python -c "from importlib.metadata import version; assert(version('{{ name }}')=='{{ version }}')"
    # pymsalruntime is not available in the channel to call upstream tests

about:
  home: https://github.com/AzureAD/microsoft-authentication-library-for-python
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: Microsoft Authentication Library (MSAL) for Python makes it easy to authenticate to Azure Active Directory
  description: |
    The MSAL library for Python enables your app to access the Microsoft Cloud by supporting
    authentication of users with Microsoft Azure Active Directory accounts and Microsoft Accounts
    using industry standard OAuth2 and OpenID Connect.
  doc_url: https://msal-python.readthedocs.io
  dev_url: https://github.com/AzureAD/microsoft-authentication-library-for-python

extra:
  recipe-maintainers:
    - roederja
    - dhirschfeld